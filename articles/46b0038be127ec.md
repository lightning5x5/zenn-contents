---
title: "PowerShell ã®è¦‹ãŸç›®ã‚’ã‚¤ã‚¤æ„Ÿã˜ã«ã™ã‚‹"
emoji: "ğŸ¥¸"
type: "tech"
topics: ["windows", "powershell", "powerline"]
published: true
---
 

Windows Terminal ã®è¦‹ãŸç›®ãŒã‚¤ãƒã‚¤ãƒã‚¤ã‚±ã¦ãªã„ãªãã¨æ€ã„ã€è¦‹ãŸç›®ã‚’ã‚¤ã‚¤æ„Ÿã˜ã«ã—ã¦ã¿ã¾ã—ãŸã€‚  
PowerShell è‡ªä½“ã¸ã®è¨­å®šã®ãŸã‚ã€VSCode ã‚„ IDE ãªã©ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã‚‚åŒã˜ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚


# è¨­å®šå®Œäº†å¾Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«

![](/images/46b0038be127ec/terminal.png)

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³

- Windows: 11
- PowerShell: 7.4.1
- Windows Terminal: 1.19.10573.0
- posh-git: 1.1.0
- oh-my-posh: 19.12.0


# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

## 1. Git ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Git ãŒä½¿ãˆã‚Œã°ãªã‚“ã§ã‚‚è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚  
ç§ã¯ [Git for Windows](https://gitforwindows.org/) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ãŸã€‚  

ã¾ãŸã€ãƒ‘ã‚¹ã‚‚åˆã‚ã›ã¦é€šã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚

## 2. Windows Terminal ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

[Microsoft Store](https://apps.microsoft.com/detail/9n0dx20hk701?hl=ja-jp&gl=JP) ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚  

## 3. PowerShell 7ç³»ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

OS ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å…¥ã£ã¦ã„ã‚‹5ç³»ã¨ã¯åˆ¥ã«ã€æ–°ãŸã«7ç³»ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```powershell
winget install --id Microsoft.Powershell --source winget
```

## 4. Powerline ã‚’ä½¿ã†ãŸã‚ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### a. oh-my-posh

PowerShell ã®ãƒ†ãƒ¼ãƒç®¡ç†ãªã©ã‚’è¡Œã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```powershell
winget install JanDeDobbeleer.OhMyPosh -s winget
```

### b. posh-git

Git ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®è¡¨ç¤ºã‚’ã„ã„æ„Ÿã˜ã«ã—ã¦ãã‚Œã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```powershell
PowerShellGet\Install-Module posh-git -Scope CurrentUser -Force
```

PSGallery ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆã¯ `yes` ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚

## 5. ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒã®ä½œæˆ

ãƒ†ãƒ¼ãƒã¯ `paradox_dracula` ã¨ã„ã†ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒã‚’æ–°ãŸã«ä½œæˆã—ã¾ã™ã€‚  
æ—¢å­˜ã®ãƒ†ãƒ¼ãƒã® `paradox` ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒã‚’ `dracula`  ã«å¯„ã›ãŸã‚‚ã®ã§ã™ã€‚

`C:\Users\{ User }\Documents\PowerShell\Modules\oh-my-posh\5.13.0\themes\paradox_dracula.omp.json` ã‚’æ–°è¦ä½œæˆã—ã€ä»¥ä¸‹ã® JSON ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```json
{
  "$schema": "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/schema.json",
  "blocks": [
    {
      "type": "prompt",
      "alignment": "left",
      "segments": [
        {
          "type": "root",
          "style": "powerline",
          "powerline_symbol": "\uE70F",
          "foreground": "100E23_1ï¿¼",
          "background": "FFE9AA_1ï¿¼",
          "properties": {
            "root_icon": "\uE70F"
          }
        },
        {
          "type": "path",
          "style": "powerline",
          "powerline_symbol": "\uE0B0",
          "foreground": "100E23_1ï¿¼",
          "background": "BD93F9_1ï¿¼",
          "properties": {
            "folder_icon": "\uF115",
            "folder_separator_icon": " \uE0B1 ",
            "style": "full"
          }
        },
        {
          "type": "git",
          "style": "powerline",
          "powerline_symbol": "\uE0B0",
          "foreground": "193549_1ï¿¼",
          "background": "50FA7B_1ï¿¼"
        },
        {
          "type": "python",
          "style": "powerline",
          "powerline_symbol": "\uE0B0",
          "foreground": "100E23_1ï¿¼",
          "background": "906CFF_1ï¿¼",
          "properties": {
            "prefix": " \uE235 "
          }
        },
        {
          "type": "exit",
          "style": "powerline",
          "powerline_symbol": "\uE0B0",
          "foreground": "FFFFFF_1ï¿¼",
          "background": "FF8080_1ï¿¼",
          "properties": {
            "prefix": " \uE20F"
          }
        }
      ]
    }
  ],
  "final_space": true
}
```

## 6. PowerShell ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­å®š

`notepad $PROFILE` ã‚’å®Ÿè¡Œã—ã¦ã‚¨ãƒ‡ã‚£ã‚¿ã‚’èµ·å‹•ã—ã€ä»¥ä¸‹ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```powershell
# bashé¢¨ã®tabè£œå®Œ
Set-PSReadLineKeyHandler -Key Tab -Function Complete

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æœ‰åŠ¹åŒ–
Import-Module posh-git

# ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ¼ãƒã‚’æœ‰åŠ¹åŒ–
oh-my-posh init pwsh --config "$env:POSH_THEMES_PATH\paradox_dracula.omp.json" | Invoke-Expression
```

## 7. Powerline ã«å¯¾å¿œã—ãŸãƒ•ã‚©ãƒ³ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ä»Šå›ã¯ [HackGenNerd Console](https://github.com/yuru7/HackGen) ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚  

HackGen ã§ãªãã¦ã‚‚è‰¯ã„ã§ã™ãŒã€Nerd ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ³ãƒˆã‹ Nerd ã‚’åˆ¥é€”ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚  
ã‚¢ã‚¤ã‚³ãƒ³ (çµµæ–‡å­—) ã®è¡¨ç¤ºã§æ–‡å­—åŒ–ã‘ã—ã¦ã—ã¾ã„ã¾ã™ã€‚

## 8. Windows Terminal ã«ãƒ•ã‚©ãƒ³ãƒˆã¨ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒã‚’è¨­å®š

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚

```json
"profiles":
{
    // çœç•¥
    "defaults":
    {
        "colorScheme": "Dracula",
        "font":
        {
            "face": "HackGenNerd Console"
        }
    },
    // çœç•¥
}

```

## 9. ã‚·ã‚¹ãƒ†ãƒ ç’°å¢ƒå¤‰æ•°ã«ãƒ‘ã‚¹ã‚’è¿½åŠ ã™ã‚‹ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ç’°å¢ƒå¤‰æ•°ã® `Path` ã« `oh-my-posh` ã®ãƒ‘ã‚¹ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚  
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã™ã‚‹ã¨ãƒ‘ã‚¹ãŒé€šã£ã¦ãªã„ã“ã¨ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ãŸã‚ã€å¿…è¦ã§ã‚ã‚Œã°ã‚³ãƒ”ãƒšã—ã¦é€šã—ã¦ãã ã•ã„ã€‚


# å‚è€ƒ

- [https://www.beeete2.com/blog/?p=2619](https://www.beeete2.com/blog/?p=2619)
- [https://learn.microsoft.com/ja-jp/powershell/scripting/install/installing-powershell-on-windows](https://learn.microsoft.com/ja-jp/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.4)
- [https://ohmyposh.dev/docs/installation/windows](https://ohmyposh.dev/docs/installation/windows)
- [https://github.com/dahlbyk/posh-git](https://github.com/dahlbyk/posh-git)
